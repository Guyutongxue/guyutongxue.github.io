<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Configure WSL with beauty</title>
        <style>
</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
html { font-size : 100%; overflow-y : scroll; -webkit-text-size-adjust: 100%; -ms-text-size-adjust : 100%; } body { color : #444; font-family: "Georgia", "Noto Serif SC", "Source Han Serif SC", Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif; font-size : 14px; line-height: 1.5em; padding : 1em; margin : auto; max-width : 42em; background : #fefefe; } a { color : #0645ad; text-decoration: none; } a:visited { color: #0b0080; } a:hover { color: #06e; } a:active { color: #faa700; } a:focus { outline: thin dotted; } a:hover, a:active { outline: 0; } ::-moz-selection { background: rgba(255, 255, 0, 0.3); color : #000 } ::selection { background: rgba(255, 255, 0, 0.3); color : #000 } a::-moz-selection { background: rgba(255, 255, 0, 0.3); color : #0645ad } a::selection { background: rgba(255, 255, 0, 0.3); color : #0645ad } p { margin: 1em 0; } img { max-width: 100%; } h1, h2, h3, h4, h5, h6 { font-weight: normal; color : #111; line-height: 1em; } h4, h5, h6 { font-weight: bold; } h1 { font-size: 2.5em; } h2 { font-size: 2em; } h3 { font-size: 1.5em; } h4 { font-size: 1.2em; } h5 { font-size: 1em; } h6 { font-size: 0.9em; } blockquote { color : #666666; margin : 0; padding-left: 3em; border-left : 0.5em #EEE solid; } hr { display : block; height : 2px; border : 0; border-top : 1px solid #aaa; border-bottom: 1px solid #eee; margin : 1em 0; padding : 0; } pre, code, kbd, samp { color : #000; font-family: Consolas, 'Courier New', monospace; font-size : 0.98em; } pre { white-space: pre; white-space: pre-wrap; word-wrap : break-word; } b, strong { font-weight: bold; } dfn { font-style: italic; } ins { background : #ff9; color : #000; text-decoration: none; } mark { background : #ff0; color : #000; font-style : italic; font-weight: bold; } sub, sup { font-size : 75%; line-height : 0; position : relative; vertical-align: baseline; } sup { top: -0.5em; } sub { bottom: -0.25em; } ul, ol { margin : 1em 0; padding: 0 0 0 2em; } li p:last-child { margin: 0 } dd { margin: 0 0 0 2em; } img { border : 0; -ms-interpolation-mode: bicubic; vertical-align : middle; } table { border-collapse: collapse; border-spacing : 0; width : 100%; } th { border-bottom: 1px solid black; } td { vertical-align: top; } @media only screen and (min-width: 480px) { body { font-size: 16px; } } /* @media only screen and (min-width: 768px) { body { font-size: 18px; } } */ @media print { * { background: transparent !important; color : black !important; filter : none !important; -ms-filter: none !important; } body { font-size: 12pt; max-width: 100%; } a, a:visited { text-decoration: underline; } hr { height : 1px; border : 0; border-bottom: 1px solid black; } a[href]:after { content: " ("attr(href) ")"; } abbr[title]:after { content: " ("attr(title) ")"; } .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; } pre, blockquote { border : 1px solid #999; padding-right : 1em; page-break-inside: avoid; } tr, img { page-break-inside: avoid; } img { max-width: 100% !important; } @page :left { margin: 15mm 20mm 15mm 10mm; } @page :right { margin: 15mm 10mm 15mm 20mm; } p, h2, h3 { orphans: 3; widows : 3; } h2, h3 { page-break-after: avoid; } }
</style>
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-light">
        <script src="../js/markdown.js"></script>
<h1 id="configure-wsl-with-beauty">Configure WSL with beauty</h1>
<h2 id="update-to-newer-windows-version--18917">Update to newer Windows version (&gt;= 18917).</h2>
<h2 id="enable-features-and-reboot">Enable features and reboot</h2>
<pre><code class="language-PowerShell"><div>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
dism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart
</div></code></pre>
<h2 id="download-ubuntu-from-microsoft-store">Download Ubuntu from Microsoft Store.</h2>
<pre><code class="language-PowerShell"><div>bash
</div></code></pre>
<p>To initialize the OS.</p>
<h2 id="upgrade-version">Upgrade version</h2>
<pre><code class="language-PowerShell"><div>wsl --set-version Ubuntu <span class="hljs-number">2</span>
</div></code></pre>
<p>You may be asked to install a core update pack. Just follow the instruction.</p>
<h2 id="transfer-the-filesystem-to-an-other-place">Transfer the filesystem to an other place</h2>
<pre><code class="language-PowerShell"><div>wsl --export Ubuntu D:\ubuntu.tar
</div></code></pre>
<p>Remove Ubuntu from Microsoft store.</p>
<pre><code class="language-PowerShell"><div>wsl --import Ubuntu /path/to/your/favorite D:\ubuntu.tar --version <span class="hljs-number">2</span>
</div></code></pre>
<p>Modify Registry for the default user. Goto <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Lxss\</code>, where you may find a GUID stand for the distribute you just imported. Change the uid to the original one. You can find uid by tapping following command into bash:</p>
<pre><code class="language-bash"><div>cat /etc/passwd | grep &lt;username&gt;
</div></code></pre>
<p>Try again login by <code>bash</code> or <code>wsl</code>.</p>
<h2 id="prepare-for-windows-terminal">Prepare for Windows Terminal</h2>
<p>Download Windows Terminal from Microsoft Store.</p>
<p>Configure settings:</p>
<pre><code class="language-JSON"><div>{
    <span class="hljs-attr">"defaultProfile"</span>: <span class="hljs-string">"{8bb950c2-4343-563a-9788-e8a1d22d142f}"</span>, // GUID to the WSL
    <span class="hljs-attr">"initialCols"</span>: <span class="hljs-number">100</span>,
    <span class="hljs-attr">"initialRows"</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">"profiles"</span>: {
        <span class="hljs-attr">"defaults"</span>: {
            // Put settings here that you want to apply to all profiles
            // <span class="hljs-attr">"fontFace"</span>: <span class="hljs-string">"等距更纱黑体 SC"</span>,
            <span class="hljs-attr">"fontFace"</span>: <span class="hljs-string">"MesloLGS NF"</span>, // fix better with zsh-powerlevel10k, Chinese supported
            <span class="hljs-attr">"fontSize"</span>: <span class="hljs-number">10</span>,
            // <span class="hljs-attr">"useAcrylic"</span>: <span class="hljs-literal">true</span>,
            // <span class="hljs-attr">"acrylicOpacity"</span>: <span class="hljs-number">0.7</span>
        },
        <span class="hljs-attr">"lists"</span>: [] //...
    }
}
</div></code></pre>
<h2 id="register-to-explorer-context">Register to Explorer context</h2>
<p>Regedit, change directory to  <code>HKEY_CLASSES_ROOT\Directory\Background\shell</code>.</p>
<p>Add item <code>wt</code>, use string <code>Open Windows Terminal</code> as default value, add a string called <code>Icon</code> if you want.</p>
<p>Inside this item, add subitem called <code>command</code>. Use</p>
<pre><code><code><div>&quot;C:\Users\Guyutongxue\AppData\Local\Microsoft\WindowsApps\wt.exe&quot; -d  %V\.
</div></code></code></pre>
<p>as the default value.</p>
<h2 id="install-zsh-and-configure-with-theme">Install zsh and configure with theme</h2>
<pre><code class="language-Bash"><div>sudo apt install zsh
</div></code></pre>
<pre><code class="language-Bash"><div>sh -c <span class="hljs-string">"<span class="hljs-variable">$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span>
</div></code></pre>
<pre><code class="language-Bash"><div>git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/romkatv/powerlevel10k.git <span class="hljs-variable">$ZSH_CUSTOM</span>/themes/powerlevel10k
</div></code></pre>
<p>Set <code>ZSH_THEME=&quot;powerlevel10k/powerlevel10k&quot;</code> in <code>~/.zshrc</code>.</p>
<p>Type zsh and you can configure whatever you like.</p>

    </body>
    </html>